# BS

## 环境

使用anaconda 和 BeautifulSoup

## BS使用 https://zhuanlan.zhihu.com/p/134674814

导入需要用到的模块

~~~python
# 导入bs4库
from bs4 import BeautifulSoup
import requests # 抓取页面
url = 'https://search.jd.com/Search?keyword=NS&enc=utf-8&wq=NS&pvid=889a68a7669c4649831d32259c4fa5f5'
headers = {
            'User-Agent': 'Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/57.0.2987.110 Safari/537.36',
            'referer':#伪造一个访问来源 "http://www.mzitu.com/100260/2"
        }
content = requests.get(url, headers=headers)
demo = content.text  # 抓取的数据
demo

'<html><head><title>This is a python demo page</title></head>\r\n<body>\r\n<p class="title"><b>The demo python introduces several python courses.</b></p>\r\n<p class="course">Python is a wonderful general-purpose programming language. You can learn Python from novice to professional by tracking the following courses:\r\n<a href="http://www.icourse163.org/course/BIT-268001" class="py1" id="link1">Basic Python</a> and <a href="http://www.icourse163.org/course/BIT-1001870001" class="py2" id="link2">Advanced Python</a>.</p>\r\n</body></html>'
# 解析HTML页面
soup = BeautifulSoup(demo, 'html.parser')  # 抓取的页面数据；bs4的解析器
# 有层次感的输出解析后的HTML页面
print(soup.prettify())
~~~

### 1）标签，用soup.<tag>访问获得:

~~~python

soup.a # 访问标签a
# <a class="py1" href="http://www.icourse163.org/course/BIT-268001" id="link1">Basic Python</a>

soup.title
# <title>This is a python demo page</title>




~~~

### 2）标签的名字:每个都有自己的名字，通过soup.<tag>.name获取，字符串类型

~~~python

soup.a.name, soup.a.parent.name, soup.p.parent.name
# ('a', 'p', 'body')
~~~

### 3)标签的属性,一个可以有0或多个属性，字典类型,soup.<tag>.attrs

~~~python

tag = soup.a
print(tag.attrs)
# 获取属性值的两种方法
print(tag.attrs['class'], tag['class'])
print(type(tag.attrs))

# 输出
{'href': 'http://www.icourse163.org/course/BIT-268001', 'class': ['py1'], 'id': 'link1'}
['py1'] ['py1']
<class 'dict'>
~~~

### 4)NavigableString:标签内非属性字符串,格式：soup.<tag>.string, NavigableString可以跨越多个层次

~~~python

print(soup.a.string)
print(type(soup.a.string))

# 输出
Basic Python
<class 'bs4.element.NavigableString'>
~~~

### 5)基于bs4库的HTML内容遍历方法

~~~python
基于bs4库的HTML内容遍历方法
HTML基本格式:<>…</>构成了所属关系，形成了标签的树形结构

标签树的下行遍历
.contents 子节点的列表，将<tag>所有儿子节点存入列表
.children 子节点的迭代类型，与.contents类似，用于循环遍历儿子节点
.descendants 子孙节点的迭代类型，包含所有子孙节点，用于循环遍历


标签树的上行遍历
.parent 节点的父亲标签
.parents 节点先辈标签的迭代类型，用于循环遍历先辈节点
标签树的平行遍历
.next_sibling 返回按照HTML文本顺序的下一个平行节点标签
.previous_sibling 返回按照HTML文本顺序的上一个平行节点标签
.next_siblings 迭代类型，返回按照HTML文本顺序的后续所有平行节点标签
.previous_siblings 迭代类型，返回按照HTML文本顺序的前续所有平行节点标签


标签树的回退和前进
.next_element返回解析过程中下一个被解析的对象(字符串或tag)
.previous_element返回解析过程中上一个被解析的对象(字符串或tag)
.next_elements 迭代类型，返回解析过程中后续所有被解析的对象(字符串或tag)
.previous_elements迭代类型，返回解析过程中前续所有被解析的对象(字符串或tag)
~~~

### 6)基于bs4库的HTML内容的查找方法 

<>.find_all(name, attrs, recursive, string, **kwargs)
name : 对标签名称的检索字符串， 可以使任一类型的过滤器,字符串,正则表达式,列表,方法或是 True . True表示返回所有。
attrs: 对标签属性值的检索字符串，可标注属性检索
recursive: 是否对子孙全部检索，默认True
string: <>…</>中字符串区域的检索字符串
<tag>(..) 等价于 <tag>.find_all(..)
soup(..) 等价于 soup.find_all(..)
扩展方法：
<>.find() 搜索且只返回一个结果，同.find_all()参数
<>.find_parents() 在先辈节点中搜索，返回列表类型，同.find_all()参数
<>.find_parent() 在先辈节点中返回一个结果，同.find()参数
<>.find_next_siblings() 在后续平行节点中搜索，返回列表类型，同.find_all()参数
<>.find_next_sibling() 在后续平行节点中返回一个结果，同.find()参数
<>.find_previous_siblings() 在前序平行节点中搜索，返回列表类型，同.find_all()参数
<>.find_previous_sibling() 在前序平行节点中返回一个结果，同.find()参数

~~~python
方法参数
find_all(name, attrs, recursive, string, **kwargs)
find(name, attrs, recursive, string, **kwargs)

name : 对标签名称的检索字符串， 可以使任一类型的过滤器,字符串,正则表达式,列表,方法或是 True . True表示返回所有。
attrs: 对标签属性值的检索字符串，可标注属性检索
recursive: 是否对子孙全部检索，默认True
string: <>…</>中字符串区域的检索字符串##!!!利用这个找 searchlog
~~~

#### 正则表达式

<img src="https://pic4.zhimg.com/80/v2-7cbac143e40c3c53d803877906fb888b_720w.jpg" alt="img" style="zoom:150%;" />

## JS解析

### 正则表达式

### js2xml  +  xpath